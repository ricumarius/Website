window.listaproduse = [{
    id: 1,
    nume: "Ibanez AZ2204NW-MGR",
    pret: 9444,
    scala: 648,
    tip_produs: "clasica",
    categorie: "comuna",
    materiale: ["artar", "nichel", "otel", "plastic"],
    deja_acordata: false
  },
  {
    id: 2,
    nume: "Ibanez AZ47P1QM-DEB",
    pret: 6000,
    scala: 500,
    tip_produs: "clasica",
    categorie: "comuna",
    materiale: ["artar", "tei", "nichel", "plastic", "mahon"],
    deja_acordata: false
  },
  {
    id: 3,
    nume: "Ibanez AZ2402-GRM",
    pret: 3500,
    scala: 500,
    tip_produs: "clasica",
    categorie: "comanda speciala",
    materiale: ["frasin", "plastic", "artar", "nichel", "tei", "grafit"],
    deja_acordata: false
  },
  {
    id: 4,
    nume: "Ibanez AZ2204NWL-MGR",
    pret: 3200,
    scala: 620,
    tip_produs: "clasica",
    categorie: "aniversara",
    materiale: ["otel", "plastic", "artar", "arin", "nichel", "fag", "aur"],
    deja_acordata: false
  },
  {
    id: 5,
    nume: "Ibanez GRGM21M-BLT",
    pret: 6000,
    scala: 780,
    tip_produs: "clasica",
    categorie: "comuna",
    materiale: ["cupru", "artar", "aur", "nichel", "satin"],
    deja_acordata: true
  },
  {
    id: 6,
    nume: "Nimic",
    pret: 700,
    scala: 0,
    tip_produs: "clasica",
    categorie: "acordata",
    materiale: [],
    deja_acordata: false
  },
  {
    id: 7,
    nume: "Ibanez RG652AHM-NGB",
    pret: 2500,
    scala: 800,
    tip_produs: "electrica",
    categorie: "comuna",
    materiale: ["plastic", "mahon", "artar", "nichel", "fagure", "grafit", "aluminiu"],
    deja_acordata: false
  },
  {
    id: 8,
    nume: "Ibanez PS60-SSL",
    pret: 8000,
    scala: 720,
    tip_produs: "electrica",
    categorie: "comuna",
    materiale: ["tei", "nichel", "mahon", "alama", "artar", "plastic"],
    deja_acordata: false
  },
  {
    id: 9,
    nume: "Ibanez TOD10 Tim Henson",
    pret: 12000,
    scala: 550,
    tip_produs: "electrica",
    categorie: "aniversara",
    materiale: ["artar", "nichel", "ulm", "plastic", "mahon"],
    deja_acordata: false
  },
  {
    id: 10,
    nume: "Ibanez GRGR221PA-AQB",
    pret: 3.2, // posibilă greșeală în SQL-ul original
    scala: 520,
    tip_produs: "electrica",
    categorie: "aniversara",
    materiale: ["artar", "nichel", "plasticina", "mahon", "ulm"],
    deja_acordata: true
  },
  {
    id: 11,
    nume: "Ibanez RG550-PN",
    pret: 7000,
    scala: 700,
    tip_produs: "electrica",
    categorie: "aniversara",
    materiale: ["mahon", "ulm", "frasin", "artar", "nichel", "plastic"],
    deja_acordata: false
  },
  {
    id: 12,
    nume: "Ibanez GRX70QA-TBB GIO",
    pret: 5000,
    scala: 285,
    tip_produs: "electrica",
    categorie: "comuna",
    materiale: ["artar", "nichel", "plastic/pvc", "mahon", "tei", "alama"],
    deja_acordata: false
  },
  {
    id: 13,
    nume: "Ibanez GRG121DX-BKF",
    pret: 15000,
    scala: 385,
    tip_produs: "clasica",
    categorie: "comanda speciala",
    materiale: ["artar", "nichel", "plastic", "aur", "mahon", "diamant"],
    deja_acordata: false
  },
  {
    id: 14,
    nume: "Ibanez AZ2407F-BSR",
    pret: 2000,
    scala: 700,
    tip_produs: "electrica",
    categorie: "comuna",
    materiale: ["alama", "artar", "nichel", "plastic", "mahon", "lemn de trandafir"],
    deja_acordata: false
  },
  {
    id: 15,
    nume: "Ibanez JEMJR-WH",
    pret: 6000,
    scala: 510,
    tip_produs: "clasica",
    categorie: "pentru incepatori",
    materiale: ["tei", "plastic", "nichel", "grafit", "artar"],
    deja_acordata: false
  },
  {
    id: 16,
    nume: "Ibanez AZ47P1QM-BIB",
    pret: 1800,
    scala: 370,
    tip_produs: "acustica",
    categorie: "comuna",
    materiale: ["ceramica", "nichel", "alama", "lemn de trandafir", "plastic", "cupru", "tei", "otel"],
    deja_acordata: false
  },
  {
    id: 17,
    nume: "Ibanez RG550-DY",
    pret: 12000,
    scala: 470,
    tip_produs: "acustica",
    categorie: "editie limitata",
    materiale: ["ceramica", "nichel", "alama", "lemn de trandafir", "plastic", "cupru", "tei", "otel"],
    deja_acordata: false
  },
  {
    id: 18,
    nume: "Ibanez AZES40-BK",
    pret: 14000,
    scala: 440,
    tip_produs: "acustica",
    categorie: "pentru incepatori",
    materiale: ["otel", "ceramica", "nichel", "grafit", "artar", "plastic", "cupru"],
    deja_acordata: false
  },
  {
    id: 19,
    nume: "Ibanez GRX70QA-TKS GIO",
    pret: 8000,
    scala: 530,
    tip_produs: "acustica",
    categorie: "comuna",
    materiale: ["otel", "ceramica", "nichel", "grafit", "artar", "plastic", "cupru"],
    deja_acordata: false
  },
  {
    id: 20,
    nume: "Ibanez RG550-RF",
    pret: 5000,
    scala: 530,
    tip_produs: "acustica",
    categorie: "comuna",
    materiale: ["ceramica", "otel"],
    deja_acordata: false
  },
  {
    id: 21,
    nume: "Ibanez GRG131DX-BKF",
    pret: 7000,
    scala: 640,
    tip_produs: "clasica",
    categorie: "pentru incepatori",
    materiale: ["plastic", "tei", "nichel"],
    deja_acordata: false
  }
];
const CHEIE_COMPARARE = "produseComparare";

function getProduseComparate() {
  const raw = localStorage.getItem(CHEIE_COMPARARE);
  return raw ? JSON.parse(raw) : [];
}

function afiseazaComparatie() {
  const produse = getProduseComparate();
  if (produse.length !== 2) {
    document.getElementById("comparare-produse").innerHTML = "<p>Trebuie să selectezi exact 2 produse pentru comparare.</p>";
    return;
  }

  const toateProdusele = window.listaproduse;
  let produseDetaliate = produse.map(p => {
    const idNum = parseInt(p.id); // Asta e cheia!
    return toateProdusele.find(item => item.id === idNum) || p;
  });

  let produs1 = produseDetaliate[0];
  let produs2 = produseDetaliate[1];

  let html = `
    <table border="1" cellpadding="5">
      <tr><th>Proprietate</th><th>${produs1.nume}</th><th>${produs2.nume}</th></tr>
      <tr><td>Preț</td><td>${produs1.pret}</td><td>${produs2.pret}</td></tr>
      <tr><td>Scală</td><td>${produs1.scala}</td><td>${produs2.scala}</td></tr>
      <tr><td>Tip produs</td><td>${produs1.tip_produs}</td><td>${produs2.tip_produs}</td></tr>
      <tr><td>Categorie</td><td>${produs1.categorie}</td><td>${produs2.categorie}</td></tr>
      <tr><td>Materiale</td><td>${(produs1.materiale || []).join(", ")}</td><td>${(produs2.materiale || []).join(", ")}</td></tr>
      <tr><td>Deja acordată</td><td>${produs1.deja_acordata ? "DA" : "NU"}</td><td>${produs2.deja_acordata ? "DA" : "NU"}</td></tr>
    </table>
  `;

  document.getElementById("comparare-produse").innerHTML = html;
}

document.addEventListener("DOMContentLoaded", () => {
  // const produseTest = JSON.stringify([{id: 1}, {id: 2}]);
  // if (localStorage.getItem(CHEIE_COMPARARE) !== produseTest) {
  //   localStorage.setItem(CHEIE_COMPARARE, produseTest);
  //   location.reload();
  //   return;
  // }
  afiseazaComparatie();
});